using Test
using CryptoPRG.Verificatum: PRG
using CryptoPRG: HashSpec
using CryptoGroups
using SigmaProofs.Verificatum.GeneratorBasis: ecp_generator_basis

g = @ECGroup{P_256}()

hasher = HashSpec("sha256")
seed = Vector{UInt8}("SEED")
prg = PRG(hasher, seed)

(gx, gy) = value(g)
q = order(g)

F = CryptoGroups.Curves.field(typeof(g.x))
p = CryptoGroups.Fields.modulus(F)

N = 10

@test ecp_generator_basis(prg, (gx, gy), p, q, N) == [
(104651337780571713029566301876825187008218514516236738225437066730141728823113, 53365301262428523137335359339499879609619018885784030368478284798918264604271),
 (99646496732105877350213558456223882067882774802465031584116594472019415134110, 32864423691742963247632583608589818869643289826522022874971892288281665950369),
 (96032475013756987472562718305275382088601285915006881313950390088928607454352, 666815372886797258309332981446919666593293755810202971816614029056887462609),
 (89703793555739254978202659219630380813458949547659520963067166629677589906606, 31907765222439342644823639539867088967513944198055026190170103509922681812124),
 (42000852772133927953081467576262095958147108649433248173454146126804793030519, 13962188340072141195651174263290093365393954145715846923146583471452137055223),
 (87494455418685558184701435005649903575301569481238200766726462348713374092537, 49568724059648465557802669414528225641402314498281895394232779792127491224965),
 (36491063327456906242943401822184143693688126279365965171569765690116352460081, 36991753273534176030095598631495305201591485835551775099034238801460951130835),
 (107795740906247603702372933256569425462677165004284746815254981620341967451837, 48624478595270557279298301681178983512414045040120944665435267020454071242710),
 (113123023551859088612935840959492563972060162848397642651832808102658155967513, 32688825609361985802571757070452724944842686734049463645750327308604772004576),
 (25745490803399959728511816741121535859972750841372888409631168809019024151679, 18142214801456051764009409949307289050184942205342374243415039170732802385487)
]
